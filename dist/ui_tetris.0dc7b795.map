{"version":3,"sources":["ui_tetris.js"],"names":["w","h","score","document","getElementById","stage","next","d","getElementsByTagName","offsetWidth","style","width","height","tetris","Tetris","on","a","b","innerHTML","addCls","nextTile","join","replace","res","start","pause","interval","startTime","timer","cb","run","fn","t","Date","now","setInterval","stop","clearInterval","btn","slice","btns","call","forEach","addEventListener","e","cls","className","left","right","rotate","down","fall","rmCls"],"mappings":"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","file":"ui_tetris.0dc7b795.map","sourceRoot":"..","sourcesContent":["var w, h;\nw = 15;\nh = 25;\nvar score = document.getElementById('score');\nvar stage = document.getElementById('stage');\nvar next = document.getElementById('next');\nvar d = stage.getElementsByTagName('div')[0].offsetWidth;\nstage.style.width = w*d + 'px';\nstage.style.height = h*d + 'px';\nnext.style.width = 4*d + 'px';\nnext.style.height = 4*d + 'px';\nvar tetris = new Tetris(w, h, 800).on('score', function(a, b) {\n  score.innerHTML = +score.innerHTML + b*b*10 ;\n})\n.on('lose', function() {\n  addCls(stage, 'gameover');\n})\n.on('pause', function() {\n  addCls(stage, 'pause');\n})\n.on('start', function(nextTile) {\n  next.innerHTML = nextTile.join('').replace(/0/g, '<div></div>').replace(/1/g, '<div class=\"on\"></div>');\n})\n.on('render', function(res) {\n  stage.innerHTML = res.join('').replace(/0/g, '<div></div>').replace(/1/g, '<div class=\"on\"></div>')\n})\n.start();\n\ntetris.pause();\n\n\nvar interval = (function() {\n  var startTime, timer, interval, cb;\n  return {\n    run: function(fn, t) {\n      cb = fn;\n      interval = t || 100;\n      startTime = Date.now();\n      timer = setInterval(function() {\n        fn && fn();\n      }, interval);\n    },\n    stop: function() {\n      timer && clearInterval(timer);\n      if(Date.now() - startTime < interval) {\n        cb && cb();\n      }\n    }\n  }\n})();\n\nvar btn;\nvar slice = [].slice;\nvar btns = slice.call(document.getElementById('manipulate').getElementsByTagName('div'));\nbtns.forEach(function(btn) {\n  btn.addEventListener('touchstart', function(e) {\n    var cls = this.className;\n    addCls(this, 'active')\n    switch(cls) {\n      case 'left':\n        return interval.run(function() {\n          tetris.left();\n        })\n      case 'right':\n        return interval.run(function() {\n          tetris.right();\n        })\n      case 'up':\n        return interval.run(function() {\n          tetris.rotate();\n        })\n      case 'down':\n        return interval.run(function() {\n          tetris.down();\n        }, 70)\n      case 'fall':\n        tetris.fall();\n    }\n  });\n\n\n  btn.addEventListener('touchend', function(e) {\n    rmCls(this, 'active')\n    interval.stop();\n  })\n})"]}